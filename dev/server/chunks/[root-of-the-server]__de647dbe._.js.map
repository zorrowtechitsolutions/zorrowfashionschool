{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 136, "column": 0}, "map": {"version":3,"sources":["file:///Users/farhan/Downloads/zorrow-fashion-school/app/api/send-admission-email/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nconst nodemailer = require(\"nodemailer\");\n\nexport async function POST(request: Request) {\n  try {\n    const body = await request.json();\n    const { name, email, phone, course } = body;\n\n    console.log(\"Received form data:\", { name, email, phone, course });\n\n    // Validate required fields\n    if (!name || !email || !phone || !course) {\n      return NextResponse.json(\n        { error: \"All fields are required\" },\n        { status: 400 }\n      );\n    }\n\n    // Configure transporter\n    const transporter = nodemailer.createTransport({\n      service: \"gmail\",\n      auth: {\n        user: process.env.EMAIL_USER,\n        pass: process.env.EMAIL_APP_PASSWORD,\n      },\n    });\n\n    // Verify transporter configuration\n    await transporter.verify();\n    console.log(\"Transporter verified successfully\");\n\n    // HTML email template for applicant\n    const applicantHtml = `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2 style=\"color: #ec4899;\">Thank You for Your Interest, ${name}!</h2>\n        <p>We have received your application with the following details:</p>\n        <table style=\"border-collapse: collapse; width: 100%; margin: 20px 0;\">\n          <tr>\n            <td style=\"padding: 10px; border: 1px solid #ddd;\"><strong>Full Name:</strong></td>\n            <td style=\"padding: 10px; border: 1px solid #ddd;\">${name}</td>\n          </tr>\n          <tr>\n            <td style=\"padding: 10px; border: 1px solid #ddd;\"><strong>Email:</strong></td>\n            <td style=\"padding: 10px; border: 1px solid #ddd;\">${email}</td>\n          </tr>\n          <tr>\n            <td style=\"padding: 10px; border: 1px solid #ddd;\"><strong>Phone:</strong></td>\n            <td style=\"padding: 10px; border: 1px solid #ddd;\">${phone}</td>\n          </tr>\n          <tr>\n            <td style=\"padding: 10px; border: 1px solid #ddd;\"><strong>Course:</strong></td>\n            <td style=\"padding: 10px; border: 1px solid #ddd;\">${course}</td>\n          </tr>\n        </table>\n        <p>Our admissions team will contact you within 24 hours to discuss the next steps.</p>\n        <p>We look forward to helping you start your fashion journey!</p>\n        <p>Best regards,<br>ZORROW School of Fashion Team</p>\n      </div>\n    `;\n\n    // HTML email template for admin\n    const adminHtml = `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2 style=\"color: #ec4899;\">New Admission Application</h2>\n        <p>A new application has been received:</p>\n        <table style=\"border-collapse: collapse; width: 100%; margin: 20px 0;\">\n          <tr>\n            <td style=\"padding: 10px; border: 1px solid #ddd;\"><strong>Name:</strong></td>\n            <td style=\"padding: 10px; border: 1px solid #ddd;\">${name}</td>\n          </tr>\n          <tr>\n            <td style=\"padding: 10px; border: 1px solid #ddd;\"><strong>Email:</strong></td>\n            <td style=\"padding: 10px; border: 1px solid #ddd;\">${email}</td>\n          </tr>\n          <tr>\n            <td style=\"padding: 10px; border: 1px solid #ddd;\"><strong>Phone:</strong></td>\n            <td style=\"padding: 10px; border: 1px solid #ddd;\">${phone}</td>\n          </tr>\n          <tr>\n            <td style=\"padding: 10px; border: 1px solid #ddd;\"><strong>Course:</strong></td>\n            <td style=\"padding: 10px; border: 1px solid #ddd;\">${course}</td>\n          </tr>\n          <tr>\n            <td style=\"padding: 10px; border: 1px solid #ddd;\"><strong>Applied On:</strong></td>\n            <td style=\"padding: 10px; border: 1px solid #ddd;\">${new Date().toLocaleString()}</td>\n          </tr>\n        </table>\n        <p>Please review this application and contact the applicant within 24 hours.</p>\n      </div>\n    `;\n\n    // Plain text versions\n    const applicantText = `\nThank You for Your Interest, ${name}!\n\nWe have received your application with the following details:\n\nFull Name: ${name}\nEmail: ${email}\nPhone: ${phone}\nCourse: ${course}\n\nOur admissions team will contact you within 24 hours to discuss the next steps.\n\nWe look forward to helping you start your fashion journey!\n\nBest regards,\nZORROW School of Fashion Team\n    `;\n\n    const adminText = `\nNew Admission Application\n\nA new application has been received:\n\nName: ${name}\nEmail: ${email}\nPhone: ${phone}\nCourse: ${course}\nApplied On: ${new Date().toLocaleString()}\n\nPlease review this application and contact the applicant within 24 hours.\n    `;\n\n    // Send email to applicant\n    const applicantMessage = {\n      from: `\"ZORROW School of Fashion\" <${process.env.EMAIL_USER}>`,\n      to: email,\n      subject: \"Your Application to ZORROW School of Fashion\",\n      html: applicantHtml,\n      text: applicantText,\n    };\n\n    // Send email to admin\n    const adminMessage = {\n      from: `\"ZORROW Admissions\" <${process.env.EMAIL_USER}>`,\n      to: process.env.ADMIN_EMAIL || process.env.EMAIL_USER,\n      subject: `New Admission Application: ${name} - ${course}`,\n      html: adminHtml,\n      text: adminText,\n    };\n\n    // Send emails\n    await transporter.sendMail(applicantMessage);\n    await transporter.sendMail(adminMessage);\n\n    return NextResponse.json(\n      { message: \"Application submitted successfully! Check your email for confirmation.\" },\n      { status: 200 }\n    );\n\n  } catch (err: any) {\n    console.error(\"Email sending error:\", err);\n    \n    return NextResponse.json(\n      { \n        error: \"Failed to send email. Please try again.\",\n        details: err.message \n      },\n      { status: 500 }\n    );\n  }\n}"],"names":[],"mappings":";;;;AAAA;;AACA,MAAM;AAEC,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG;QAEvC,QAAQ,GAAG,CAAC,uBAAuB;YAAE;YAAM;YAAO;YAAO;QAAO;QAEhE,2BAA2B;QAC3B,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,QAAQ;YACxC,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA0B,GACnC;gBAAE,QAAQ;YAAI;QAElB;QAEA,wBAAwB;QACxB,MAAM,cAAc,WAAW,eAAe,CAAC;YAC7C,SAAS;YACT,MAAM;gBACJ,MAAM,QAAQ,GAAG,CAAC,UAAU;gBAC5B,MAAM,QAAQ,GAAG,CAAC,kBAAkB;YACtC;QACF;QAEA,mCAAmC;QACnC,MAAM,YAAY,MAAM;QACxB,QAAQ,GAAG,CAAC;QAEZ,oCAAoC;QACpC,MAAM,gBAAgB,CAAC;;iEAEsC,EAAE,KAAK;;;;;+DAKT,EAAE,KAAK;;;;+DAIP,EAAE,MAAM;;;;+DAIR,EAAE,MAAM;;;;+DAIR,EAAE,OAAO;;;;;;;IAOpE,CAAC;QAED,gCAAgC;QAChC,MAAM,YAAY,CAAC;;;;;;;+DAOwC,EAAE,KAAK;;;;+DAIP,EAAE,MAAM;;;;+DAIR,EAAE,MAAM;;;;+DAIR,EAAE,OAAO;;;;+DAIT,EAAE,IAAI,OAAO,cAAc,GAAG;;;;;IAKzF,CAAC;QAED,sBAAsB;QACtB,MAAM,gBAAgB,CAAC;6BACE,EAAE,KAAK;;;;WAIzB,EAAE,KAAK;OACX,EAAE,MAAM;OACR,EAAE,MAAM;QACP,EAAE,OAAO;;;;;;;;IAQb,CAAC;QAED,MAAM,YAAY,CAAC;;;;;MAKjB,EAAE,KAAK;OACN,EAAE,MAAM;OACR,EAAE,MAAM;QACP,EAAE,OAAO;YACL,EAAE,IAAI,OAAO,cAAc,GAAG;;;IAGtC,CAAC;QAED,0BAA0B;QAC1B,MAAM,mBAAmB;YACvB,MAAM,CAAC,4BAA4B,EAAE,QAAQ,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC;YAC9D,IAAI;YACJ,SAAS;YACT,MAAM;YACN,MAAM;QACR;QAEA,sBAAsB;QACtB,MAAM,eAAe;YACnB,MAAM,CAAC,qBAAqB,EAAE,QAAQ,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC;YACvD,IAAI,QAAQ,GAAG,CAAC,WAAW,IAAI,QAAQ,GAAG,CAAC,UAAU;YACrD,SAAS,CAAC,2BAA2B,EAAE,KAAK,GAAG,EAAE,QAAQ;YACzD,MAAM;YACN,MAAM;QACR;QAEA,cAAc;QACd,MAAM,YAAY,QAAQ,CAAC;QAC3B,MAAM,YAAY,QAAQ,CAAC;QAE3B,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;QAAyE,GACpF;YAAE,QAAQ;QAAI;IAGlB,EAAE,OAAO,KAAU;QACjB,QAAQ,KAAK,CAAC,wBAAwB;QAEtC,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,SAAS,IAAI,OAAO;QACtB,GACA;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}